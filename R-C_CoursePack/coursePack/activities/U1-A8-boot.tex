\def\theTopic{Textbook Costs}
\def\dayNum{8 }
 %% was 11 in Spring 2016

\section{Bootstrap  Confidence Interval for $\mu$}


We would like to know how much the ``typical'' MSU students spends on
books each semester.  Is this a question we can answer by testing?
  We need an estimate, and as you now know, we like interval
estimates because they include some information about uncertainty.

So far, the tools we have for working with a mean have allowed us to
test a pre-specified value, not estimate an unknown parameter.
We have a point estimate: a sample mean, $\xb$, but we don't know how
variable it is because we don't know $\sigma$, the true standard
deviation of the data points. 

{\bf Problem}:\\
We need to know the sampling distribution to know how far away our
statistic might be from our parameter.  We know the sampling
distribution of $ \xb$ is centered at the population mean, $\mu$, and
we know some things about its spread and shape.   However, the sampling
distribution  of $\xb$ depends on the unknown parameters $\mu$ and $\sigma$. How
can we estimate $\mu$?  


{\bf Solution}:\\Use the ``Resampling'' or Bootstrap distribution as a
substitute for the unknown sampling distribution.
\vspace{-.2in}
\begin{center}
	{\bf\sf	We only draw {\bf one} sample from the population!}
\end{center}

Hang onto that idea, because we will use our one sample  in an almost
magical way to generate something very much like the sampling
distribution.   

% When a computer ``boots up'' it goes from a dead state with no
% electrons moving through it to a live state where it's ready to accept
% instruction.  The word ``boot'' comes from ``bootstrap'' and a silly
% tale about Baron Munchausen who got himself out of quicksand by
% pulling on his bootstraps.  In statistics our objective is to take our
% one sample and create many samples from it. That seems a bit
% impossible, but computer scientists figured how to make a computer
% boot up, and similarly, statisticians have figured out how to measure
% sampling variation when we have only a single sample. 

  A {\bf bootstrap resample} is the same size as the original data, and
  consists of data points from the original data.  The only difference
  is that the resampling is done ``with replacement'' so a bootstrap
  resample typically contains several replicates of some values and is
  missing other values completely.  We can repeat this process many
  times and store the statistics generated from each resample.  The
  result is a bootstrap distribution (or a resampling distribution)
  which can be used as a replacement for the unknown sampling
  distribution.  In particular, we can use the spread (standard error)
  of the bootstrapped sample statistics as a substitute for the spread
  (standard error) of our statistic.  

   

Go to  the applet:\\
\webAppURLFrst and 
select \fbox{Bootstrap Demo}under  \fbox{One Quant}.
\vspace{-.2in}
\begin{enumerate}
  \item  The counts shown are all the values in the ``population'', which
    are amounts (in 10's of dollars) stat students in a prior semester
    spent on textbooks.  We will pretend that this is the entire
    population in order to see how well our methods work.
    \begin{enumerate}
    \item  Click \fbox{Sample} and we'll get a random sample of size
      8 from this population.  The population then disappears because
      we never can observe an entire population. Some of your numbers
      might be the same, but they came from different individuals in
      the population.  Click \fbox{Get New Sample} at the bottom of
      the page, and you'll get a new sample.  How many samples do 
       we collect in one study?
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
   {\it AWV. just one. }
\end{key}
    \item  Click \fbox{1 Resample} and watch what happens. Click
      \fbox{slower} 1 or 2 times and watch it again.  What is this
      button doing?
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
   {\it It selects 8 values from the sample with replacement, pulls
    each down to the next line, and leaves a colored spot on each one
    it grabbed.  The resample then gets combined (averaged) to a
    single value and that is plotted on the dotplot scale.}
\end{key}
    \item  Slow it down to where you can answer these questions: For
      one resample, which of the original eight values got used more
      than once? which not at all?
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
   {\it AWV.}
\end{key}
    \item Get 8 cards from your instructor and write each of the 8 values in
      your sample on a card.  Create your own bootstrap resample to
      mimic what the computer does.  Which of these methods works?
      (Circle one.)
      \begin{enumerate}
      \item Select one card at random, leave it out, and select
        another card.  Continue until you use all the cards.
      \item Select one card at random and write down its
        value. Replace it, reshuffle, and select another.  Continue
        until you've written down eight  values. 
      \end{enumerate}
      % Explain which technique copies what the computer does when it
      % collects one resample.
\begin{students}
        \vspace{.2cm}        
\end{students}
\begin{key}
\ \  \\
  {\it The second -- sampling With Replacement is what we are doing
    on the computer. The first way always gives the same resample
    mean -- they just change order. The second lets the resample mean vary.}
\end{key}

\item What statistic are we interested in (from the sample)?  Compute
  it for the resample. 
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
  \\{\it mean, $\xb$, AWV}
\end{key}

\item  Click \fbox{100}  in the ``Many Resamples'' choices.
  \begin{enumerate}
  \item  Explain  what values are being plotted.  
\begin{students}
        \vspace{2cm}        
\end{students}
\begin{key}
  \\{\it It takes  100 resamples, computes the mean of
    each, and plots the 100 resample means. }
\end{key}
  \item A common quiz/exam question is ``What does one dot
    represent?''. Explain where the values came from and what
    statistic was computed to make one dot. 
\begin{students}
        \vspace{2.5cm}        
\end{students}
\begin{key}
  \\{\it One dot is the mean of one resample which was found by
    randomly selecting 8  values from the sample with replacement. We
    then average them     together.}
\end{key}
\end{enumerate}

\item  Click \fbox{500}  in the ``Many Resamples'' choices.
 Write down the interval estimate.  Count
      (approximately) how many circles are outside the red
      lines at the left and at the right.
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
  \\{\it (16.4, 55.4)  I see about 12 circles below and  12 above the interval.}
\end{key}
\\
  Repeat twice more. Write down each confidence interval and guess how
  many points fall outside each.
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
{\it AWV. I got (18.1, 54.9), (18.3, 54.9)}
\end{key}

\item Click  1000,  5000,and 10000 in turn. Write down
  three CI's for each.  Compare the CI's.  Are some groups off-center compared
  to others?  More variable?

\begin{students}
\vspace{4cm}
\end{students}
\begin{key}
  {\it The smaller numbers of resamples give more variability in
    CI. Centers don't change.}
\end{key}


\item Go back to 500 resamples.  What happens to length of intervals
  when we change confidence levels?  Hint: choose a different
  confidence level with the buttons, then click \fbox{500} again
  to obtain the interval.\\
\begin{students}
{\large \tt
\begin{tabular}{rc}
from 95\% to 99\% --	&	intervals  \underline{\hspace*{2in}}\\
from 95\% to 90\% --	&	intervals \underline{\hspace*{2in}}\\
\end{tabular}
}
\end{students}
\begin{key}
going from 95\% to 99\%  confidence 	intervals get longer\\
going from 95\% to 90\%  confidence 	intervals get shorter
\end{key}
    \end{enumerate}


\item When we started, we saw the whole population of counts
    which has true mean  $\mu = 34.5$ (\$345).
    \begin{enumerate}
    \item  Look back at the 90\% interval you wrote down. Did it
      contain the true value? Write ``Hit'' or ``Miss''.
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
  {\it AWV. All of mine did.}
\end{key}

\item  We'll now pretend that we can grab new samples and we will
  build two 90\% CI's from each as a check of consistency.
 For each row of the table, click \fbox{Get New Sample} once, then
 click \fbox{1000} to get a 90\% CI for $\mu$.  Record whether your
 first interval covers 34.5 (Hits) or not (Misses). Click  \fbox{1000}
 again, and write  ``missed'' or ``hit'' in the third column.\vspace{.5cm}\\
\begin{students}
  \begin{tabular}{l|c|c|c|}
   Click \fbox{New Sample} & \fbox{1000} Hit or Missed?&  \fbox{1000}
   Hit or Missed?& Same?\\ 
    \hline
1   \ \ & \ \ & \ \ & \ \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
2   \ \ & \ \ & \ \ & \ \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
3   \ \ & \ \ & \ \ & \ \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
4   \ \ & \ \ & \ \ & \  \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
5   \ \ & \ \ & \ \ & \  \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
 \end{tabular}

  \begin{tabular}{l|c|c|c|}
   Click \fbox{New Sample} & \fbox{1000} Hit or Missed?&  \fbox{1000}
   Hit or Missed?& Same?\\ 
    \hline
6   \ \ & \ \ & \ \ & \  \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
7   \ \ & \ \ & \ \ & \ \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
8   \ \ & \ \ & \ \ & \ \\ 
   \ \ & \ \ & \ \ & \ \\   \hline
9   \ \ & \ \ & \ \ & \  \\ 
   \ \ & \ \ & \ \ & \  \\   \hline
10   \ \ & \ \ & \ \ & \  \\ 
   \ \ & \ \ & \ \ & \  \\   \hline
  \end{tabular}
\end{students}

   In each line above put a check in the last column if the 2
   intervals agreed (both hit or both missed). 
   Does coverage depend more on the sample or on the particular resample?

\begin{students}
        \vspace{2cm}        
\end{students}
\begin{key}
 {\it The sample.  This is just like the simulation we did for
    proportions, but the method for computing the confidence interval
    is different.  We can get a ``good'' or ``bad'' sample, but given
    the sample, the method is consistent.  }
\end{key}
\end{enumerate}
\item With proportions we used $\widehat{p} \pm 2 SE$ as our
  confidence interval.  For means, we have extra variation from not
  knowing the spread, $\sigma$, so the correct multiplier depends on
  sample size as well as confidence level.  For sample size $n=8$, the
  multiplier is $t_7^* = 2.36$ for 95\% confidence, 3.50 for 99\%
  confidence, and 1.89 for 90\% confidence.  The web app shows
  standard error of the resampled means as SD, so we use this as our
  SE.  Build 90, 95, and 99\% CI's using the $\xb \pm t^* SE$ method.
  Also write the bootstrap intervals to compare.\\
  \begin{enumerate} 
  \item Compute the mean of your sample (from the 8 values, not the
    ``Mean'' printed) \\ $\xb =$ 
\begin{key} 
 {\it AWV, mine is 24.125}
\end{key}
\item a 90\% CI for $\mu$ is (show work)
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
 {\it AWV, $24.125 \pm  1.89 \times 5.25 = (14.2, 34.1)$\\
     Bootstrap: (15.4, 32.5)}
\end{key}
\item a 95\% CI for $\mu$ is (show work)
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
 {\it AWV, $24.125 \pm  2.36 \times 5.39 = (11.4, 36.8)$\\
     Bootstrap: (13.8, 35)}
\end{key}
\item a 99\% CI for $\mu$ is (show work)
\begin{students}
        \vspace{1cm}        
\end{students}
\begin{key}
 {\it AWV, $24.125 \pm  3.50 \times 5.31 = ( 5.5, 42.7)$\\
     Bootstrap: (11.3, 36.9)}
\end{key}
\end{enumerate}
\item Is there a pattern when you compare the two methods?  Are
  bootstrap percentile methods always wider? shifted? relative to the 
 $\xb \pm t^* SE$ intervals?
\begin{students}
        \vspace{3cm}        
\end{students}
\begin{key}
  \\ {\it Bootstrap intervals are narrower.  There is a tendency for
    the $\xb \pm t^* SE$ intervals to be   too symmetric. }
\end{key}

\item Challenge: based on what you've seen so far in this course what
  will happen to our interval estimates if we 
  change  sample size from 8 to  4?  From 8 to 16?\\
   Will smaller sample size shift the center?
\begin{students}
        \vspace{.5cm}        \\
\end{students}
\begin{key}
{\it No, both are unbiased.}
\end{key}

Will smaller sample size change the width?
\begin{students}
        \vspace{.5cm}        
\end{students}
\begin{key}
\\{\it Yes, width should increase.}
\end{key}

   Will larger sample size shift the center?
\begin{students}
        \vspace{.5cm}        
\end{students}
\begin{key}
\\{\it No, both are unbiased.}
\end{key}

   Will larger sample size  change the width?\\
\begin{students}
        \vspace{.5cm}        
\end{students}
\begin{key}
\\ {\it Yes, width should shrink.}
\end{key}

   Try it and record what happens to center and spread.  (Yes, it is
   important to write it down. It will show up on the exam.)  Using
   just one sample may not give you a good comparison.  Try several
   samples at each sample size. 
   \vfill
\end{enumerate}

\begin{center}
  {\bf Take Home Messages}
\end{center}
\begin{itemize}
  \item   We only get one SAMPLE, but from it we can generate many
    resamples.
  \item We can use the resampling distribution to see how much
    samples vary. It is a substitute for the unknown sampling
    distribution.
  \item Whether the interval includes the parameter or not
    depends mainly on our luck in sampling.  Most samples give statistics
    close to the parameter, but some can be farther away.
  \item We can use the bootstrap information in two ways:
    \begin{itemize}
    \item to compute the SE of the statistic
    \item to find percentiles of the resampling distribution.
    \end{itemize}
   Either method can give a confidence interval.  With symmetric data, the
   two should agree well.  These data are skewed to the right, and the
   bootstrap percentile intervals are preferred.
 \item 
  Questions?  What is not clear?\vfill
  \end{itemize}
  

\noindent
{\bf Assignment} \vspace{-.2in}
\begin{itemize}
\item  D2Quiz 5 is due Sept 22.  Fill it in online.
\item {\bf D2Box 4} is due Sept 26. 
 %%  We strongly encourage you to get help in the Math Learning Center.
% \item View the video on Bootstrap - \# 3 under Unit 2.
\item Watch videos assigned on D2L.
 \item Fill in the top three boxes of column 2 in the Review
   Table. Skip testing and fill in the bootstrap confidence interval. 
\item Read the next two pages before your next class.
\end{itemize}

